
# 🔥 火星搜索 (Huoxing Search) - 完整项目文档

> **版本**: v1.0.0  
> **发布日期**: 2025-01-20  
> **语言**: Go 1.21+  
> **框架**: Gin + GORM  
> **原项目**: Xinyue-Search（心悦搜索）PHP版

---

## 📋 目录

1. [项目概述](#-项目概述)
2. [核心特性](#-核心特性)
3. [快速开始](#-快速开始)
4. [配置说明](#-配置说明)
5. [功能使用](#-功能使用)
6. [技术架构](#-技术架构)
7. [测试清单](#-测试清单)
8. [常见问题](#-常见问题)
9. [免责声明](#️-免责声明)

---

## 🎯 项目概述

**火星搜索 (Huoxing-Search)** 是一个高性能的网盘资源搜索和转存系统，从 PHP 版 Xinyue-Search 完全重构为 Go 语言版本，性能提升 **5-10 倍**，资源占用降低 **70%**。

### 🎉 重大更新

- ✅ 完成从 PHP 到 Go 的完整重构
- ✅ 深度集成 **Pansou 搜索引擎**（50+ 插件）
- ✅ 支持 5 种网盘（夸克、百度、阿里、UC、迅雷）
- ✅ Docker 一键部署，配置统一管理
- ✅ 完整的微信集成（公众号 + 对话平台）

### 📊 性能对比

| 指标 | PHP版本 | Go版本 | 提升 |
|------|---------|--------|------|
| 搜索响应 | 2-5秒 | <1秒 | **5-10倍** ⬆️ |
| 并发能力 | 50-100 QPS | 1000+ QPS | **10倍** ⬆️ |
| 转存速度 | 3-8秒 | <2秒 | **3-4倍** ⬆️ |
| 内存占用 | 500MB-1GB | <200MB | **降低70%** ⬇️ |
| CPU占用 | 60-80% | <40% | **降低50%** ⬇️ |

---

## ✨ 核心特性

### 🚀 高性能
- **Go语言重写**：并发处理能力强，资源占用低
- **智能缓存**：Redis缓存 + 内存缓存双重加速
- **并发转存**：最多5个同时转存，避免风控
- **快速启动**：< 2秒启动，80MB 轻量镜像

### 🔍 搜索功能
- **Pansou深度集成**：50+ 搜索插件，覆盖全网资源
- **多网盘支持**：夸克、百度、阿里云盘、UC、迅雷
- **智能排序**：自动去重、优先级排序
- **结果缓存**：60秒有效期，避免重复搜索

### 💾 转存功能
- **一键转存**：支持5种网盘快速转存
- **批量导入**：支持批量链接导入
- **广告过滤**：自动过滤转存广告
- **有效性检测**：转存前检查链接有效性

### 📱 微信集成
- **对话开放平台**：支持智能对话
- **公众号回调**：支持公众号消息回调
- **消息去重**：防止重复处理消息
- **异步处理**：消息异步处理，提升响应速度

### 🎨 现代化界面
- **响应式设计**：支持PC和移动端
- **管理后台**：功能完善的后台管理
- **Web安装向导**：零配置快速部署

---

## 🚀 快速开始

### 📦 系统要求

**最低配置**：
- CPU: 1核
- 内存: 512MB
- 磁盘: 1GB
- MySQL: 8.0+

**推荐配置**：
- CPU: 2核+
- 内存: 2GB+
- 磁盘: 10GB+
- MySQL: 8.0+
- Redis: 7.0+（可选）

### 方式一：Docker部署（强烈推荐）⭐

```bash
# 1. 克隆项目
git clone https://github.com/your-repo/huoxing-search.git
cd huoxing-search

# 2. 启动服务（会自动构建镜像）
docker-compose up -d

# 3. 查看日志
docker-compose logs -f

# 4. 访问安装向导
# http://localhost:6060/install
```

**Docker 配置说明**：

安装向导中的数据库配置：
- **数据库地址**：`mysql`（Docker容器名）
- **数据库端口**：`3306`
- **数据库用户**：`root`
- **数据库密码**：`123456`（见 docker-compose.yml）
- **数据库名称**：`huoxing`

**Docker 管理命令**：

```bash
# 停止服务
docker-compose down

# 重启服务
docker-compose restart

# 查看运行状态
docker-compose ps

# 查看日志
docker-compose logs -f app

# 进入容器
docker-compose exec app sh

# 清理所有数据（重新安装）
docker-compose down -v
rm -rf data/
docker-compose up -d
```

### 方式二：直接运行

**前提条件**：
- MySQL 8.0+ 已安装并运行
- Redis 7.0+（可选）
- 已下载编译好的可执行文件

**启动步骤**：

```bash
# Windows
huoxing-search.exe

# Linux/Mac
chmod +x huoxing-search
./huoxing-search
```

访问安装向导：http://localhost:6060/install

### 方式三：源码编译

```bash
# 1. 安装 Go 1.21+
# 2. 下载依赖
go mod tidy

# 3. 编译
go build -o huoxing-search cmd/server/main.go

# 4. 运行
./huoxing-search
```

---

## 🔧 配置说明

### 1. 安装向导配置

访问 http://localhost:6060/install 完成首次安装。

#### 数据库配置
- **主机**：MySQL服务器地址
  - 本地：`localhost` 或 `127.0.0.1`
  - Docker：`mysql`
- **端口**：默认 `3306`
- **用户名**：MySQL用户名
- **密码**：MySQL密码
- **数据库名**：建议 `huoxing`（不存在会自动创建）
- **表前缀**：默认 `qf_`
- **SSL连接**：本地MySQL建议关闭

#### 管理员配置
- **用户名**：后台登录用户名（建议不要用 admin）
- **密码**：后台登录密码（建议使用强密码，至少6位）

#### 网站信息
- **网站名称**：默认"火星网盘搜索"
- **其他**：可在后台"系统配置"中修改

### 2. 网盘配置

安装完成后，在管理后台"网盘配置"中配置：

#### 夸克网盘
1. 登录 [夸克网盘](https://pan.quark.cn)
2. 按 F12 打开开发者工具 → Network 标签
3. 刷新页面，找到任意请求
4. 复制请求头中的 Cookie
5. 粘贴到后台"网盘配置"
6. 点击"测试连接"验证

#### 百度网盘
1. 登录 [百度网盘](https://pan.baidu.com)
2. 按 F12 → Network 标签
3. 刷新页面，复制 Cookie
4. 粘贴到后台配置
5. 测试连接

#### 阿里云盘
1. 登录 [阿里云盘](https://www.alipan.com)
2. 按 F12 → Application/存储 标签
3. 找到 Local Storage 中的 `refresh_token`
4. 粘贴到后台配置
5. 测试连接

#### UC网盘、迅雷网盘
配置方法类似，复制对应网盘的 Cookie 即可。

**注意事项**：
- Cookie 有效期通常为 30 天，需定期更新
- 配置后务必点击"测试连接"验证
- 至少配置一个网盘才能使用转存功能

### 3. 微信配置（可选）

在管理后台"微信配置"中配置：

#### 微信对话开放平台
1. 登录微信对话开放平台
2. 创建应用，获取：AppID、Token、EncodingAESKey
3. 在后台"微信配置"中填入
4. 设置回调URL：`https://你的域名/api/wechat/chat`
5. 点击"测试连接"验证

#### 微信公众号
1. 登录微信公众平台
2. 进入"开发" → "基本配置"
3. 获取 Token 和 EncodingAESKey
4. 在后台"微信配置"中填入
5. 设置服务器URL：`https://你的域名/api/wechat/official`

**重要提示**：
- 微信回调需要 **HTTPS**，请配置 Nginx 反向代理
- 开发环境可使用内网穿透工具（如 ngrok）

---

## 🎨 功能使用

### 前台搜索

1. 访问首页：http://localhost:6060
2. 输入关键词（如："速度与激情"）
3. 选择网盘类型（夸克、百度等）
4. 点击搜索
5. 查看搜索结果并点击链接或转存

### 后台管理

访问：http://localhost:6060/admin/login

#### 1. 仪表盘
- 查看系统统计（资源数、访问量等）
- 查看系统版本信息

#### 2. 资源管理
- 查看、搜索、编辑、删除资源
- 按网盘类型、状态筛选

#### 3. 批量导入
- 单个或批量链接导入
- 支持多种分享链接格式

#### 4. 分类管理
- 添加/编辑/删除分类
- 设置分类关键词

#### 5. 系统配置
- 基础配置、搜索配置
- 配置热更新，保存后立即生效

#### 6. 网盘配置
- 配置5种网盘的Cookie/Token
- 测试连接功能

#### 7. 微信配置
- 配置公众号和对话平台
- 测试连接功能

---

## 🏗️ 技术架构

### 技术栈

| 层级 | 技术 | 版本 | 说明 |
|------|------|------|------|
| 后端语言 | Go | 1.21+ | 高性能、低资源 |
| Web框架 | Gin | v1.9+ | 轻量高效 |
| ORM | GORM | v2.0+ | 功能完善 |
| 数据库 | MySQL | 8.0 | 稳定可靠 |
| 缓存 | Redis | 7.0 | 高性能（可选） |
| 搜索引擎 | Pansou | latest | 50+插件 |
| 容器化 | Docker | latest | 标准化部署 |

---

## 🧪 测试清单

### 核心功能测试

- [ ] 